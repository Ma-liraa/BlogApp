import React from "react";
import ButtonIcon from "./ButtonIcon";
import { likePostApi } from "@/services/postServices";
import toast from "react-hot-toast";
import { useRouter } from "next/navigation";

function LikeIcon({ post }) {
  const router = useRouter();
  const likeHandler = async (postId) => {
    try {
      const { message } = await likePostApi(postId);
      toast.success(message);
      router.refresh();
    } catch (error) {
      toast.error(error?.response?.data?.message);
    }
  };
  return (
    <ButtonIcon
      className="absolute left-2 top-2"
      variant="red"
      onClick={() => likeHandler(post._id)}
    >
      {post.isLiked ? (
        <svg
          className="h-4 w-4"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M2 9.1371C2 14 6.01943 16.5914 8.96173 18.9109C10 19.7294 11 20.5 12 20.5C13 20.5 14 19.7294 15.0383 18.9109C17.9806 16.5914 22 14 22 9.1371C22 4.27416 16.4998 0.825464 12 5.50063C7.50016 0.825464 2 4.27416 2 9.1371Z" />
        </svg>
      ) : (
        <svg
          className="h-3 w-3"
          viewBox="0 0 18 18"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M6.7213 14.1831L7.18561 13.5941L6.7213 14.1831ZM9 4.12544L8.45963 4.64554C8.60102 4.79244 8.79612 4.87544 9 4.87544C9.20388 4.87544 9.39898 4.79244 9.54036 4.64554L9 4.12544ZM11.2787 14.1831L11.743 14.7721L11.2787 14.1831ZM6.7213 14.1831L7.18561 13.5941C6.03774 12.6892 4.81553 11.8294 3.84391 10.7353C2.898 9.67017 2.25 8.44233 2.25 6.85279H1.5H0.75C0.75 8.91046 1.60928 10.478 2.72234 11.7313C3.80969 12.9557 5.19812 13.9374 6.25698 14.7721L6.7213 14.1831ZM1.5 6.85279H2.25C2.25 5.30979 3.12161 4.02556 4.29622 3.48864C5.42355 2.97334 6.96414 3.09178 8.45963 4.64554L9 4.12544L9.54036 3.60534C7.66098 1.65273 5.45157 1.31125 3.67262 2.12441C1.94095 2.91596 0.75 4.74859 0.75 6.85279H1.5ZM6.7213 14.1831L6.25698 14.7721C6.63944 15.0736 7.06194 15.4049 7.49302 15.6568C7.92386 15.9086 8.4346 16.125 9 16.125V15.375V14.625C8.8154 14.625 8.57614 14.5524 8.24981 14.3617C7.92371 14.1711 7.58186 13.9065 7.18561 13.5941L6.7213 14.1831ZM11.2787 14.1831L11.743 14.7721C12.8019 13.9374 14.1903 12.9557 15.2777 11.7313C16.3907 10.478 17.25 8.91046 17.25 6.85279H16.5H15.75C15.75 8.44233 15.102 9.67017 14.1561 10.7353C13.1845 11.8294 11.9623 12.6892 10.8144 13.5941L11.2787 14.1831ZM16.5 6.85279H17.25C17.25 4.74859 16.059 2.91596 14.3274 2.12441C12.5484 1.31125 10.339 1.65273 8.45963 3.60534L9 4.12544L9.54036 4.64554C11.0359 3.09178 12.5765 2.97334 13.7038 3.48864C14.8784 4.02556 15.75 5.30979 15.75 6.85279H16.5ZM11.2787 14.1831L10.8144 13.5941C10.4181 13.9065 10.0763 14.1711 9.75019 14.3617C9.42386 14.5524 9.1846 14.625 9 14.625V15.375V16.125C9.5654 16.125 10.0761 15.9086 10.507 15.6568C10.9381 15.4049 11.3606 15.0736 11.743 14.7721L11.2787 14.1831Z" />
        </svg>
      )}
      <span>{post.likesCount}</span>
    </ButtonIcon>
  );
}

export default LikeIcon;
